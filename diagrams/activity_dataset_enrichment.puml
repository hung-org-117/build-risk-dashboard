@startuml
title Dataset Validation and Enrichment

|Admin|
start
:Upload dataset file;
:Map required fields (repo_name, build_id);

|System|
:Validate file schema and store dataset;

|Admin|
:Configure repositories for dataset;

|System|
:Validate repositories;

|Github|
:Verify repository existence and access;

|System|
:Validate builds with CI provider;

|CI Provider|
:Return build metadata;

|System|
if (Validation successful?) then (yes)
  :Mark dataset as validated;

  |Admin|
  :Select features and create version;

  |System|
  :Run enrichment pipeline;
  :Generate enriched dataset version;
  :Prepare download output;

  |Admin|
  :Download version;

  |System|
  if (Commit scanning requested?) then (yes)
    |Admin|
    :Select commits and scan tool;

    |System|
    :Start scan job;

    |Scan Tools|
    :Run scan on selected commits;

    |System|
    :Store scan results and update status;
  endif
  stop
else (no)
  :Report validation errors;
  |Admin|
  :Fix mapping or repository list;
  stop
endif
@enduml
